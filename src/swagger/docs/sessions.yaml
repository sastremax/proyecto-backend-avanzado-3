paths:
  /api/sessions/register:
    post:
      summary: Registrar un nuevo usuario
      tags:
        - Autenticación
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                first_name:
                  type: string
                  example: Fran
                last_name:
                  type: string
                  example: Sastre
                email:
                  type: string
                  example: fsastre@example.com
                password:
                  type: string
                  example: 12345678
                age:
                  type: integer
                  example: 18
      responses:
        '201':
          description: Usuario registrado correctamente
        '400':
          description: Error en los datos enviados

  /api/sessions/login:
    post:
      summary: Iniciar sesión de usuario
      tags:
        - Autenticación
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                  example: sastrebocalonmaximiliano@example.com
                password:
                  type: string
                  example: 12345678
              required:
                - email
                - password
      responses:
        "200":
          description: Login exitoso
          content:
            application/json:
              example:
                status: success
                message: Login successful
                data:
                  token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
        "401":
          description: Credenciales inválidas
          content:
            application/json:
              example:
                status: error
                error: "Email o contraseña incorrectos"
        "500":
          description: Error interno del servidor
          content:
            application/json:
              example:
                status: error
                error: "Error al intentar iniciar sesión"

  /api/sessions/current:
    get:
      summary: Obtener el usuario autenticado
      tags:
        - Autenticación
      security:
        - bearerAuth: []
      responses:
        "200":
          description: Usuario actual obtenido exitosamente
          content:
            application/json:
              example:
                status: success
                message: Current user
                data:
                  first_name: Maxi
                  last_name: Sastre
                  email: sastrebocalonmaximiliano@example.com
                  role: admin
        "401":
          description: No autorizado
          content:
            application/json:
              example:
                status: error
                error: "No autorizado: se requiere autenticación."

  /api/sessions/logout:
    get:
      summary: Cerrar sesión del usuario
      tags:
        - Autenticación
      responses:
        '200':
          description: Sesión cerrada correctamente
        '401':
          description: No autorizado

  /api/sessions/forgot-password:
    post:
      summary: Solicitar recuperación de contraseña
      tags:
        - Autenticación
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                  example: sastrebocalonmaximiliano@example.com
      responses:
        '200':
          description: Email enviado para restablecer contraseña
        '404':
          description: Usuario no encontrado

  /api/sessions/reset-password:
    post:
      summary: Restablecer contraseña
      tags:
        - Autenticación
      parameters:
        - in: query
          name: token
          required: true
          schema:
            type: string
          description: Token JWT recibido por email
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                  example: usuario@example.com
                password:
                  type: string
                  example: NuevaClave123
      responses:
        '200':
          description: Contraseña actualizada correctamente
        '400':
          description: Token inválido o error en la actualización
